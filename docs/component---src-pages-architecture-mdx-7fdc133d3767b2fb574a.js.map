{"version":3,"file":"component---src-pages-architecture-mdx-7fdc133d3767b2fb574a.js","mappings":"sQAQaA,EAAe,GACtBC,EAAc,CAClBD,aAAAA,GAEIE,EAAYC,EAAAA,EACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,GACF,YACD,OAAO,QAACJ,EAAD,iBAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,eAG5E,cACE,GAAM,eACN,MAAS,CACP,SAAY,cAEb,aAAGC,WAAW,KACb,KAAQ,gBACR,aAAc,yBACd,UAAa,kBACZ,eAAKA,WAAW,IACf,cAAe,OACf,UAAa,QACb,OAAU,KACV,QAAW,MACX,QAAW,YACX,MAAS,OACR,gBAAMA,WAAW,MAChB,SAAY,UACZ,EAAK,oVAlBb,iBAoBA,cACE,GAAM,oBACN,MAAS,CACP,SAAY,cAEb,aAAGA,WAAW,KACb,KAAQ,qBACR,aAAc,8BACd,UAAa,kBACZ,eAAKA,WAAW,IACf,cAAe,OACf,UAAa,QACb,OAAU,KACV,QAAW,MACX,QAAW,YACX,MAAS,OACR,gBAAMA,WAAW,MAChB,SAAY,UACZ,EAAK,oVAlBb,sBAoBA,2HACA,yBAAW,sBAAYA,WAAW,KAAvB,gBAAX,iCAAoG,sBAAYA,WAAW,KAAvB,cAApG,8CAAwM,sBAAYA,WAAW,KAAvB,oBAAxM,UAA8Q,sBAAYA,WAAW,KAAvB,oBAA9Q,+DAAyY,sBAAYA,WAAW,KAAvB,iBAAzY,uDACA,cACE,GAAM,mBACN,MAAS,CACP,SAAY,cAEb,aAAGA,WAAW,KACb,KAAQ,oBACR,aAAc,6BACd,UAAa,kBACZ,eAAKA,WAAW,IACf,cAAe,OACf,UAAa,QACb,OAAU,KACV,QAAW,MACX,QAAW,YACX,MAAS,OACR,gBAAMA,WAAW,MAChB,SAAY,UACZ,EAAK,oVAlBb,qBAoBA,kBAAG,gBAAMA,WAAW,IAChB,UAAa,4BACb,MAAS,CACP,SAAY,WACZ,QAAW,QACX,WAAc,OACd,YAAe,OACf,SAAY,WAPf,YAUC,aAAGA,WAAW,OACZ,UAAa,yBACb,KAAQ,qGACR,MAAS,CACP,QAAW,SAEb,OAAU,SACV,IAAO,YAPT,UASF,gBAAMA,WAAW,IACX,UAAa,qCACb,MAAS,CACP,cAAiB,sBACjB,SAAY,WACZ,OAAU,IACV,KAAQ,IACR,gBAAmB,oiBACnB,eAAkB,QAClB,QAAW,WAlBjB,QAqBJ,eAAKA,WAAW,IACR,UAAa,0BACb,IAAO,uBACP,MAAS,uBACT,IAAO,qGACP,OAAU,CAAC,0GAA2G,0GAA2G,2GAA4G,4GAC7U,MAAS,oCACT,MAAS,CACP,MAAS,OACT,OAAU,OACV,OAAU,IACV,cAAiB,SACjB,SAAY,WACZ,IAAO,IACP,KAAQ,KAEV,QAAW,OACX,SAAY,UAtChB,QAVD,YAoDH,+GACA,igBACA,qQACA,2pBACA,6TAA+S,sBAAYA,WAAW,KAAvB,gBAA/S,+BAAsY,sBAAYA,WAAW,KAAvB,WAAtY,qDAA8e,sBAAYA,WAAW,KAAvB,gBAA9e,MAA4iB,sBAAYA,WAAW,KAAvB,oBAA5iB,UAAknB,sBAAYA,WAAW,KAAvB,mBAAlnB,iEACA,uJACA,oWACA,qZACA,2GAKJJ,EAAWK,gBAAiB,G,qBCnJb,SAASC,EAA8BC,EAAQC,GAC5D,GAAc,MAAVD,EAAgB,MAAO,GAC3B,IAEIE,EAAKC,EAFLC,EAAS,GACTC,EAAaC,OAAOC,KAAKP,GAG7B,IAAKG,EAAI,EAAGA,EAAIE,EAAWG,OAAQL,IACjCD,EAAMG,EAAWF,GACbF,EAASQ,QAAQP,IAAQ,IAC7BE,EAAOF,GAAOF,EAAOE,IAGvB,OAAOE,E","sources":["webpack://@monodeploy/gatsby/./src/pages/architecture.mdx","webpack://@monodeploy/gatsby/../.yarn/cache/@babel-runtime-npm-7.18.6-6a59ef0d54-8b707b64ae.zip/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/monodeploy/monodeploy/gatsby/src/components/Layout.tsx\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2 {...{\n      \"id\": \"architecture\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#architecture\",\n        \"aria-label\": \"architecture permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Architecture`}</h2>\n    <h3 {...{\n      \"id\": \"code-organization\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h3\" {...{\n        \"href\": \"#code-organization\",\n        \"aria-label\": \"code organization permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Code Organization`}</h3>\n    <p>{`The Monodeploy codebase is organized as a monorepo, and ultimately uses monodeploy to publish itself.`}</p>\n    <p>{`The `}<inlineCode parentName=\"p\">{`packages/cli`}</inlineCode>{` directory contains the root `}<inlineCode parentName=\"p\">{`monodeploy`}</inlineCode>{` package, which is a loose wrapper around `}<inlineCode parentName=\"p\">{`@monodeploy/node`}</inlineCode>{`. The `}<inlineCode parentName=\"p\">{`@monodeploy/node`}</inlineCode>{` package houses the pipeline logic and acts similar to the `}<inlineCode parentName=\"p\">{`@private/core`}</inlineCode>{` package of other popular monorepo based projects.`}</p>\n    <h3 {...{\n      \"id\": \"publish-pipeline\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h3\" {...{\n        \"href\": \"#publish-pipeline\",\n        \"aria-label\": \"publish pipeline permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Publish Pipeline`}</h3>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1000px\"\n        }\n      }}>{`\n      `}<a parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-link\",\n          \"href\": \"https://tophat.github.io/monodeploy/static/2924c676d843af95f1c23e3ee9a8da51/f2763/architecture.png\",\n          \"style\": {\n            \"display\": \"block\"\n          },\n          \"target\": \"_blank\",\n          \"rel\": \"noopener\"\n        }}>{`\n    `}<span parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-background-image\",\n            \"style\": {\n              \"paddingBottom\": \"27.200000000000003%\",\n              \"position\": \"relative\",\n              \"bottom\": \"0\",\n              \"left\": \"0\",\n              \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQY0x3Na3LTMBQG0Oz/P5RhK5npFjp52pL1tHT1sGsndTAOVOhjYAPn7I5irFw6ML9SI+irbA4QzeHTigY8PisPT7DwazuYdd9JW3prEX1fYwggCmCp4NQkSO6h1IQdpx9V2oiWNgrOflljg8GLzy2ckfSlGnZElMfnSeTXgUxZssbav9XBXDA6hjb9Ae8GJEuwMmMn6FHH6Y4ubqRE9zLbMzS/lqU/4sNf65wJa2TPA6NXpW35F/SKV6cFklOQYUEn3xFthP4Pxq3meQWPv4Pu+PcHXRAMKz/phLu/1DlZPEKzXVXaR8vLSBrZnOvQt1jeCTffQPAELxxMl7Djfql5nNC6B3Fhvt08Q+67MvsW0t+qcDcIf9/O/boPzpQ5GmSnanQaEylkryHsHbYfoMyEv/7xaUfYRdPwAAAAAElFTkSuQmCC')\",\n              \"backgroundSize\": \"cover\",\n              \"display\": \"block\"\n            }\n          }}></span>{`\n  `}<img parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"alt\": \"Architecture Diagram\",\n            \"title\": \"Architecture Diagram\",\n            \"src\": \"https://tophat.github.io/monodeploy/static/2924c676d843af95f1c23e3ee9a8da51/00d43/architecture.png\",\n            \"srcSet\": [\"https://tophat.github.io/monodeploy/static/2924c676d843af95f1c23e3ee9a8da51/63868/architecture.png 250w\", \"https://tophat.github.io/monodeploy/static/2924c676d843af95f1c23e3ee9a8da51/0b533/architecture.png 500w\", \"https://tophat.github.io/monodeploy/static/2924c676d843af95f1c23e3ee9a8da51/00d43/architecture.png 1000w\", \"https://tophat.github.io/monodeploy/static/2924c676d843af95f1c23e3ee9a8da51/f2763/architecture.png 1291w\"],\n            \"sizes\": \"(max-width: 1000px) 100vw, 1000px\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            },\n            \"loading\": \"lazy\",\n            \"decoding\": \"async\"\n          }}></img>{`\n  `}</a>{`\n    `}</span></p>\n    <p>{`The high-level of the pipeline aims to be simple, with most complexities abstracted away.`}</p>\n    <p>{`In the first stage of the pipeline, after initialization, we use the loaded conventional changelog config to determine the packages which have been explicitly bumped via commit messages. An explicitly bumped package is always directly included in the commits ranging from the base commit to the publish commit. The conventional changelog configuration is ultimately responsible for correct parsing of the commit messages, and for the correctness of the version strategy determiner algorithm.`}</p>\n    <p>{`The determination of the version strategies by package is the beginning of the creation of Monodeploy's \"changeset\". This changeset is enhanced a few times throughout the pipeline before ultimately being written out to the changeset file.`}</p>\n    <p>{`Once we have the explicit version strategies, we determine the implicit strategies. This is accomplished by traversing the dependencies graph and finding all dependents of the explicitly bumped packages, excluding dependents which themselves are explicitly bumped. These dependent packages are automatically given a patch version strategy. This is to ensure downstream consumers of the explicitly bumped packages receive updates. If using package groups (similar to Lerna's fixed mode), the greatest strategy is assumed for each group. Note that if no groups are specified, monodeploy defaults to treat each package as its own independent group.`}</p>\n    <p>{`The collection of version strategies associated with the individual packages are now read to apply the version strategy (e.g. \"minor\") to the latest version of each package. Each package group resolves to use the largest version number among the group for each of its members. Package manifests (`}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` files) are updated so the `}<inlineCode parentName=\"p\">{`version`}</inlineCode>{` of the manifest, and the versions listed in the `}<inlineCode parentName=\"p\">{`dependencies`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`peerDependencies`}</inlineCode>{`, and `}<inlineCode parentName=\"p\">{`devDependencies`}</inlineCode>{` fields reflect the latest versions we are about to publish.`}</p>\n    <p>{`After manifest files are updated, Yarn triggers an install to update the Yarn lockfile, as well as any other install state files.`}</p>\n    <p>{`Once the manifests of all packages we will be publishing are updated, we trigger a publish to the specified NPM-like registry. Before and after publishing each package, the appropriate npm lifecycle hooks are executed. These hooks are guaranteed to be executed in topological order, if the topological configuration option is enabled.`}</p>\n    <p>{`At this point, the changeset information for each published package is piped through the loaded conventional changelog config, and changelog files are written. Depending on configuration options, the changelog files, and the modified package manifests are committed. If enabled, release git tags are created then created, and the tagged commit is pushed to the remote git repository.`}</p>\n    <p>{`At various steps throughout the pipepline, Monodeploy plugin hooks will be triggered.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent","_objectWithoutPropertiesLoose","source","excluded","key","i","target","sourceKeys","Object","keys","length","indexOf"],"sourceRoot":""}